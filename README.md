

# 催债程序

## 一期

### 需求

- 保存用户信息/欠债人信息
- 保存用户的债务信息
  - 债务完成后自动结束债务流程
  - 债务信息到期后自动添加不良记录
- 保存债务流程
  - 新建债务时自动创建债务流程
  - 新建债务流程后自动结束上一流程,并且更新债务信息的约定日期.
- 不良记录
  - 债权人可以删除不良记录
- 根据用户的债务信息给欠债人发短息.
  - 债务开始时可选择是否短信提醒
  - 债务最后一日短信提醒,同时发给债权人和在债务人
  - 债务超期后每日短信提醒债务人

### 表设计

#### 通用
| 字段        | 类型     | 长度 | 含义     | 是否为空 | 备注                             |
| ----------- | -------- | ---- | -------- | -------- | -------------------------------- |
| id          | bigint   | 20   | 主键     | 否       |                                  |
| create_user | bigint   | 20   | 创建人   | 否       | 关联用户表                       |
| update_user | bigint   | 20   | 更新用户 | 否       | 关联用户表                       |
| create_time | datetime |      | 创建时间 | 否       | 默认当前时间,current_timestamp() |
| update_time | datetime |      | 更新时间 | 否       | 默认更新时的当前时间             |


#### 用户表(base_user)

| 字段      | 类型    | 长度 | 含义   | 是否允许为空 | 备注                         |
| --------- | ------- | ---- | ------ | ------------ | ---------------------------- |
| 公共字段  |         |      |        |              |                              |
| name      | varchar | 100  |        | 否           |                              |
| password  | varchar | 100  |        | 否           |                              |
| nick_name | varchar | 100  | 昵称   | 是           | 默认显示名称                 |
| telephone | varchar | 20   | 手机号 | 否           | 需要发短信时标明联系方式     |
| wechat    | varchar | 100  | 微信号 | 是           | 用于发短信时标明微信联系方式 |

### 债务人表(base_debtor)

| 字段      | 类型    | 长度 | 含义   | 是否允许为空 | 备注                             |
| --------- | ------- | ---- | ------ | ------------ | -------------------------------- |
| 公共字段  |         |      |        |              ||
| name | varchar | 100 | 名称 | 否 ||
| nick_name | varchar | 100 | 昵称 | 是 ||
| telephone | varchar | 20 | 手机号 | 是 ||
| creditor_id | bigint | 20 | 债主id | 否 ||
| alert_status | tinyint | 2 | 是否有不良记录 | 否 |0否1是,默认否|

### 债务信息表(base_debt)

| 字段      | 类型    | 长度 | 含义   | 是否允许为空 | 备注                             |
| --------- | ------- | ---- | ------ | ------------ | -------------------------------- |
| 公共字段  |         |      |        |              ||
| start_time | Date | | 债务日期 | 否 |默认当天|
| argeed_time | Date | | 约定归还日期 | 否 ||
| status | tinyint | 8 | 债务状态 | 否 |0未激活1未到期2到期未归还3已完成4重新约定,默认1|
| amount | double | 20 | 债务金额 | 否 ||
| reason | varchar | 500 | 原因 | 否 ||
| end_time | date |  | 债务结束日期 | 是 ||
| creditor_id | bigint | 20 | 债权人id | 否 |关联用户表|
| debtor_id | bigint | 20 | 债务人id | 否 |关联债务人表|



### 债务流程表(base_debt_flow)

| 字段      | 类型    | 长度 | 含义   | 是否允许为空 | 备注                             |
| --------- | ------- | ---- | ------ | ------------ | -------------------------------- |
| id          | bigint   | 20   | 主键     | 否       |                                  |
| create_time | datetime |      | 创建时间 | 否       | 默认当前时间,current_timestamp() |
| update_time | datetime |      | 更新时间 | 否       | 默认更新时的当前时间             |
| debt_id | bigint | 20 | 债务id | 否 |  |
| agreed_time | date | | 约定日期 | 否 |  |
| end_time | date | | 结束日期 | 是 |  |
| reason | varchar | 500 | 更改原因 | 否 |  |
| status | tinyint | 2 | 状态 | 否 | 1未到期2到期未归还3已完成,默认1 |

### 不良债务记录(base_over_record)

| 字段      | 类型    | 长度 | 含义   | 是否允许为空 | 备注                             |
| --------- | ------- | ---- | ------ | ------------ | -------------------------------- |
| id          | bigint   | 20   | 主键     | 否       |                                  |
| create_time | datetime |      | 创建时间 | 否       | 默认当前时间,current_timestamp() |
| update_time | datetime |      | 更新时间 | 否       | 默认更新时的当前时间             |
| debt_id | bigint | 20 | 超期债务id | 否 | 关联债务表 |